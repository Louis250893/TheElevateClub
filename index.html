<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>The Elevate Club</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- IcÃ´nes & PWA -->
  <link rel="icon" href="favicon.ico" />
  <link rel="apple-touch-icon" href="apple-touch-icon.png" />
  <link rel="manifest" href="manifest.json" />

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500&family=Great+Vibes&display=swap"
    rel="stylesheet"
  />

  <style>
    :root {
      --bg: #050505;
      --card-bg: #050505;
      --text-main: #f5f0eb;
      --gold: #d7b676;
      --gold-soft: #b89356;
      --input-bg: #111;
      --input-border: #444;
      --input-border-focus: #d7b676;
      --error: #e57373;
      --success: #9ccc65;
    }

    * {
      box-sizing: border-box;
    }

    html,
    body {
      margin: 0;
      padding: 0;
      background: radial-gradient(circle at top, #111 0, #050505 45%, #000 100%);
      color: var(--text-main);
      font-family: "Playfair Display", serif;
      min-height: 100%;
    }

    body {
      display: flex;
      align-items: stretch;
      justify-content: center;
    }

    .page {
      min-height: 100vh;
      width: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 32px 16px;
    }

    .card {
      width: 100%;
      max-width: 620px;
      background: radial-gradient(circle at top, #151515 0, #050505 55%, #000 100%);
      border-radius: 18px;
      border: 1px solid rgba(215, 182, 118, 0.28);
      box-shadow:
        0 24px 60px rgba(0, 0, 0, 0.ðŸ˜Ž,
        0 0 0 1px rgba(255, 255, 255, 0.02);
      padding: 32px 22px 28px;
    }

    @media (min-width: 768px) {
      .card {
        padding: 40px 36px 34px;
      }
    }

    .logo-wrap {
      display: flex;
      justify-content: center;
      margin-bottom: 26px;
    }

    .logo {
      width: 180px;
      height: 180px;
      max-width: 55vw;
      max-height: 55vw;
      object-fit: contain;
      filter:
        drop-shadow(0 10px 24px rgba(0, 0, 0, 0.85))
        drop-shadow(0 0 16px rgba(215, 182, 118, 0.35));
    }

    @media (min-width: 768px) {
      .logo {
        width: 210px;
        height: 210px;
      }
    }

    .tagline {
      text-align: center;
      margin: 0 0 28px;
      line-height: 1.7;
      font-size: 1.05rem;
      color: var(--text-main);
      min-height: 4.8em; /* pour Ã©viter les sauts pendant lâ€™Ã©criture */
      font-family: "Great Vibes", cursive;
      letter-spacing: 0.02em;
    }

    @media (min-width: 768px) {
      .tagline {
        font-size: 1.3rem;
      }
    }

    .form-group {
      margin-bottom: 16px;
    }

    label {
      display: block;
      font-size: 0.8rem;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: rgba(245, 240, 235, 0.7);
      margin-bottom: 6px;
    }

    input,
    textarea {
      width: 100%;
      padding: 10px 12px;
      background: var(--input-bg);
      border-radius: 4px;
      border: 1px solid var(--input-border);
      color: var(--text-main);
      font-family: inherit;
      font-size: 0.95rem;
      outline: none;
      transition: border-color 0.2s, box-shadow 0.2s, background 0.2s;
    }

    input::placeholder,
    textarea::placeholder {
      color: rgba(255, 255, 255, 0.3);
    }

    input:focus,
    textarea:focus {
      border-color: var(--input-border-focus);
      box-shadow: 0 0 0 1px rgba(215, 182, 118, 0.4);
      background: #151515;
    }

    textarea {
      min-height: 90px;
      resize: vertical;
    }

    .btn-wrap {
      margin-top: 16px;
      display: flex;
      justify-content: center;
    }

    button[type="submit"] {
      cursor: pointer;
      border: none;
      padding: 12px 32px;
      background: linear-gradient(135deg, #d7b676, #f4e0b0);
      color: #201408;
      font-size: 0.9rem;
      font-weight: 500;
      letter-spacing: 0.18em;
      text-transform: uppercase;
      border-radius: 999px;
      box-shadow:
        0 12px 30px rgba(0, 0, 0, 0.7),
        0 0 0 1px rgba(0, 0, 0, 0.4);
      transition: transform 0.12s ease-out, box-shadow 0.12s ease-out,
        filter 0.12s ease-out, background 0.15s ease-out;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    button[type="submit"]:hover {
      transform: translateY(-1px);
      box-shadow:
        0 16px 36px rgba(0, 0, 0, 0.ðŸ˜Ž,
        0 0 0 1px rgba(0, 0, 0, 0.55);
      filter: brightness(1.03);
    }

    button[type="submit"]:active {
      transform: translateY(0);
      box-shadow:
        0 8px 20px rgba(0, 0, 0, 0.85),
        0 0 0 1px rgba(0, 0, 0, 0.7);
      filter: brightness(0.98);
    }

    button[type="submit"]:disabled {
      opacity: 0.65;
      cursor: default;
      transform: none;
      box-shadow:
        0 6px 18px rgba(0, 0, 0, 0.75),
        0 0 0 1px rgba(0, 0, 0, 0.5);
    }

    .notice {
      margin-top: 14px;
      font-size: 0.85rem;
      text-align: center;
      min-height: 1.4em;
      color: rgba(245, 240, 235, 0.75);
    }

    .notice.error {
      color: var(--error);
    }

    .notice.success {
      color: var(--success);
    }
  </style>
</head>

<body>
  <div class="page">
    <div class="card">
      <div class="logo-wrap">
        <!-- Ton logo 3D fixe, fond transparent -->
        <img src="logo.png" alt="The Elevate Club" class="logo" />
      </div>

      <!-- Texte manuscrit animÃ© (sans barre clignotante Ã  la fin) -->
      <p id="tagline" class="tagline"></p>

      <form id="request" autocomplete="on" novalidate>
        <div class="form-group">
          <label for="name">Votre nom</label>
          <input
            id="name"
            name="name"
            type="text"
            required
            autocomplete="name"
            placeholder="Nom complet"
          />
        </div>

        <div class="form-group">
          <label for="city">Votre ville</label>
          <input
            id="city"
            name="city"
            type="text"
            required
            autocomplete="address-level2"
            placeholder="Ville"
          />
        </div>

        <div class="form-group">
          <label for="contact">Contact (email / tÃ©lÃ©phone)</label>
          <input
            id="contact"
            name="contact"
            type="text"
            required
            autocomplete="email"
            placeholder="Ex. nom@exemple.com ou +32 4..."
          />
        </div>

        <div class="form-group">
          <label for="words">Trois mots qui vous dÃ©finissent</label>
          <input
            id="words"
            name="words"
            type="text"
            required
            placeholder="Ex. curieux, engagÃ©, dÃ©terminÃ©"
          />
        </div>

        <div class="form-group">
          <label for="note">Optionnel (note, prÃ©cision, recommandation)</label>
          <textarea
            id="note"
            name="note"
            placeholder="Recommandation, prÃ©cision, contexte, etc."
          ></textarea>
        </div>

        <div class="btn-wrap">
          <button type="submit">
            DEMANDER Lâ€™ACCÃˆS
          </button>
        </div>

        <div id="notice" class="notice"></div>
      </form>
    </div>
  </div>

  <script>
    // 1) Texte manuscrit animÃ© (sans curseur clignotant)
    (function typeTagline() {
      const text =
        "Un espace pour ceux qui avancent vraiment.\n" +
        "Pas pour paraÃ®tre. Pas pour impressionner.\n" +
        "Pour sâ€™Ã©lever, ensemble.";
      const el = document.getElementById("tagline");
      let i = 0;

      function step() {
        if (i <= text.length) {
          const current = text.slice(0, i);
          el.innerHTML = current.replace(/\n/g, "<br>");
          i++;
          setTimeout(step, 45); // vitesse dâ€™Ã©criture
        }
      }

      step();
    })();

    // 2) RÃ©cupÃ¨re le parrain dans lâ€™URL
    const PARRAIN =
      new URLSearchParams(window.location.search).get("parrain") || "NON-DÃ‰FINI";

    // 3) Envoi vers le serveur (Vercel) qui parle Ã  Airtable
    async function envoyerVersServeur(data) {
      const notice = document.getElementById("notice");
      notice.className = "notice";
      notice.textContent = "Envoi en coursâ€¦";

      try {
        const resp = await fetch(
          "https://the-elevate-club-93vs.vercel.app/api/submit",
          {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(data),
          }
        );

        if (!resp.ok) {
          const txt = await resp.text();
          console.error("Erreur serveur:", resp.status, txt);
          notice.classList.add("error");
          notice.textContent = "Erreur lors de lâ€™envoi (serveur). RÃ©essaie.";
          return;
        }

        notice.classList.add("success");
        notice.textContent = "Candidature envoyÃ©e. Merci.";
      } catch (err) {
        console.error(err);
        notice.classList.add("error");
        notice.textContent = "ProblÃ¨me rÃ©seau â€“ rÃ©essaie.";
      }
    }

    // 4) Gestion du formulaire
    document
      .getElementById("request")
      .addEventListener("submit", async (e) => {
        e.preventDefault();
        const notice = document.getElementById("notice");
        const submitBtn = e.target.querySelector('button[type="submit"]');

        const data = {
          name: e.target.name.value.trim(),
          city: e.target.city.value.trim(),
          contact: e.target.contact.value.trim(),
          words: e.target.words.value.trim(),
          note: e.target.note.value.trim(),
          parrain: PARRAIN,
        };

        if (!data.name || !data.city || !data.contact || !data.words) {
          notice.className = "notice error";
          notice.textContent = "Merci de remplir tous les champs obligatoires.";
          return;
        }

        submitBtn.disabled = true;
        await envoyerVersServeur(data);
        submitBtn.disabled = false;

        // Si succÃ¨s, on vide le formulaire
        if (notice.classList.contains("success")) {
          e.target.reset();
        }
      });
  </script>
</body>
</html>
